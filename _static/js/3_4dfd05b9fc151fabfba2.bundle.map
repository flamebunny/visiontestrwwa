{"version":3,"sources":["webpack:///./Scripts/src/Foundation/ViewModels/TotePyosViewModel.js"],"names":[],"mappings":";;;;;gEAAA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gBAAgB,OAAO,8BAA8B,UAAU,gCAAgC;AAC/F;;AAEA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA,wBAAwB;AACxB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA,YAAY;AACZ;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAAA,qG","file":"3_4dfd05b9fc151fabfba2.bundle.js","sourcesContent":["define([\"jquery\", \"../../Specials/IOC/inversify.config\", \"../Services/LoggingService\"], function (jQuery, kernel, log) {\n    \"use strict\";\n\n    var toteSelections = TOTESEL;\n\n    var pyosStore = kernel.default.get(\"PyosStore\");\n\n    function toPropositionCode(propositionType) {\n        switch (propositionType) {\n        case \"Odds\":\n            return \"ODD\";\n        case \"Evens\":\n            return \"EVN\";\n        case \"Outside\":\n            return \"OS\";\n        case \"Inside\":\n            return \"IS\";\n        default:\n            return null;\n        }\n    }\n\n    function buildPreEnquirySelection() {\n        var meetingDate = jQuery(\"#MeetingDate\").val();\n        var fixtureId = jQuery(\"#MeetingID\").val();\n        var raceNumber = jQuery(\"#Tabs_0__RaceNo\").val();\n        var starterNumber = jQuery(\"#selectedStarterNumber\").val();\n        var propositionCode = toPropositionCode(jQuery(\"#fobPropositionType\").val());\n        var propositionSeq = jQuery(\"#PropositionSequence\").val();\n        var isRacing = (meetingDate && fixtureId && raceNumber && (starterNumber || propositionCode));\n\n        if (isRacing) {\n            return {\n                StarterNumber: starterNumber,\n                RaceNumber: raceNumber,\n                FixtureId: fixtureId.toUpperCase(),\n                FixtureDateTime: meetingDate,\n                PropositionCode: propositionCode\n            };\n        } else if (propositionSeq) {\n            return {\n                PropositionSeq: propositionSeq\n            };\n        }\n        return null;\n    }\n\n    function buildPreEnquiryPriceDetails() {\n        var fixedWinPrice = jQuery(\"#FixedWinPrice\").val();\n        var fixedPlacePrice = jQuery(\"#FixedPlacePrice\").val();\n\n        return { Win: { DollarReturn: fixedWinPrice }, Place: { DollarReturn: fixedPlacePrice } };\n    }\n\n    function buildPreEnquiryStake() {\n        var returnType = jQuery(\"ul.win-or-place-selector input:checked\").val();\n        switch (returnType) {\n            case \"EachWay\":\n                return { Win: jQuery('#Investment,#Investment1').val(), Place: jQuery('#Investment,#Investment1').val() };\n            default:\n                return { Win: jQuery('#Investment,#Investment1').val(), Place: jQuery('#InvestmentPlace,#Investment2').val() };\n        }\n    }\n\n    function clear() {\n        log.logDebug(\"totePyos::clear\");\n        pyosStore.clear();\n    }\n\n    function clearErrorMessage() {\n        log.logDebug(\"totePyos::clearErrorMessage\");\n        pyosStore.clearErrorMessage();\n    }\n\n    function setStake() {\n        var stake = buildPreEnquiryStake();\n        log.logDebug(\"totePyos::bet.single.stake: \" + JSON.stringify(stake));\n        pyosStore.setStake(stake);\n    }\n\n    function setupBetAmountSubscriptions() {\n        jQuery('#Investment1,#Investment2,#Investment,#InvestmentPlace')\n            .off('input.pyosSelect change.pyosSelect')\n            .on('input.pyosSelect change.pyosSelect', function () {\n                setStake();\n            });\n\n        jQuery('ul.win-or-place-selector input')\n           .off('click.pyosSelect')\n           .on('click.pyosSelect', function () {\n               setStake();\n           });\n    }\n\n    function initBetSelection() {\n\n        setupBetAmountSubscriptions();\n\n        if (toteSelections.isFixedOddsRacing() || toteSelections.isValidFixedoddsBet()) {\n\n            var data = {\n                betSelection: buildPreEnquirySelection(),\n                priceDetails: buildPreEnquiryPriceDetails(),\n                stake: buildPreEnquiryStake()\n            };\n\n\n            log.logDebug(\"totePyos::initBetSelection:\" + JSON.stringify(data));\n\n            pyosStore.setPriceDetails(data.priceDetails);\n            pyosStore.setStake(data.stake);\n            pyosStore.setBetSelection(data.betSelection);\n            return pyosStore.enquireSpecialOffers();\n\n        } else {\n            clear();\n            return Promise.resolve();\n        }\n    }\n\n    function validate() {\n        log.logDebug(\"totePyos::validate\");\n\n        return new Promise(function (resolve, reject) {\n            if (pyosStore.validate()) {\n                resolve();\n            } else {\n                reject();\n            }\n        });\n    }\n\n    return {\n        clear: clear,\n        initBetSelection: initBetSelection,\n        clearErrorMessage: clearErrorMessage,\n        validate: validate\n    };\n});\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./Scripts/src/Foundation/ViewModels/TotePyosViewModel.js\n// module id = 404\n// module chunks = 3"],"sourceRoot":""}